<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.0  (Unix)">
	<META NAME="CREATED" CONTENT="20071107;13514400">
	<META NAME="CHANGED" CONTENT="20071108;14085600">
	<STYLE>
	<!--
		@page { size: 8.5in 11in }
		P { margin-bottom: 0in }
		P.western { font-family: "Utopia", serif; font-size: 10pt }
		P.cjk { font-family: "Verdana"; font-size: 10pt }
		P.ctl { font-family: "Verdana"; font-size: 10pt }
		H1.western { font-family: "Utopia", serif; font-size: 16pt }
		H1.cjk { font-family: "Verdana"; font-size: 16pt }
		H1.ctl { font-family: "Verdana"; font-size: 16pt }
		H2.western { font-family: "Utopia", serif; font-size: 14pt; font-style: italic }
		H2.cjk { font-family: "Verdana"; font-size: 14pt; font-style: italic }
		H2.ctl { font-family: "Verdana"; font-size: 14pt; font-style: italic }
		H3 { font-family: "Verdana"; font-size: 13pt }
		BLOCKQUOTE { border: 1px solid #dddddd; padding: 0.1in }
		BLOCKQUOTE.western { font-family: "Utopia", serif; font-size: 10pt; font-weight: medium }
		BLOCKQUOTE.cjk { font-family: "Verdana"; font-size: 10pt }
		BLOCKQUOTE.ctl { font-family: "Verdana"; font-size: 10pt }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1 CLASS="western">Installation of the WMS Collector and collocated
glidein Factory 
</H1>
<H2 CLASS="western">1. Description 
</H2>
<P CLASS="western" STYLE="margin-bottom: 0.2in">The glidein Factory
node will be the <A HREF="http://www.cs.wisc.edu/condor/manual/v6.9/3_1Introduction.html#SECTION00411000000000000000">Condor
Central Manager</A> for the WMS, i.e. it will run the Condor
Collector and Negotiator daemons, but it will also act as a <A HREF="http://www.cs.wisc.edu/condor/manual/v6.9/3_1Introduction.html#SECTION00411000000000000000">Condor
Submit node</A> for the glidein factory, running Condor schedds used
for Grid submission.<BR>On top of that, this node also hosts the
glidein factory daemons.</P>
<H2 CLASS="western">2. Hardware requirements 
</H2>
<P CLASS="western" STYLE="margin-bottom: 0.2in">This machine needs
<B>one or two CPUs</B> (one for the Condor damons, and one for the
glidein factory daemons) and a moderate amount of <B>memory</B>
(<B>512MB</B> should be enough).<BR>It must must be on the <B>public
internet</B>, with <B>at least one port open to the world</B>; all
worker nodes will load data from this node trough HTTP.<BR>The <B>disk</B>
needed is just for binaries, config files, log files and Web
monitoring data (<B>10GB</B> should be enough).</P>
<H2 CLASS="western">3. Needed software 
</H2>
<P CLASS="western" STYLE="margin-bottom: 0.2in">A reasonably recent
Linux OS (SL4 used at press time).<BR>The <A HREF="https://twiki.grid.iu.edu/twiki/bin/view/Documentation/WebHome">OSG
client software</A>.<BR>A HTTP server, like <A HREF="http://www.apache.org/">Apache</A>
or <A HREF="http://www.stllinux.org/meeting_notes/2001/0719/tux/intro.html">TUX</A>.<BR>A
<A HREF="http://www.postgresql.org/">PostgreSQL server</A>.<BR>The
<A HREF="http://www.cs.wisc.edu/condor/downloads/">Condor
distribution</A>.<BR>The <A HREF="http://oss.oetiker.ch/rrdtool/">RRDTool
package</A>.<BR>The <A HREF="http://home.fnal.gov/%7Esfiligoi/glideinWMS/">glideinWMS
software</A>.</P>
<H2 CLASS="western">4. Base tools installation instructions 
</H2>
<P CLASS="western" STYLE="margin-bottom: 0.2in">You will need to
install all tools but glideinWMS software as root. The whole process
is managed by a install script described below.  <BR>The script will
try to automate the installation as much as possible, but you may
need manually download a few tarballs and RPMs for the script to use.
The install script has pointers to the relevant URLs where you can
download them, so be prepared to have a second terminal to perform
the downloads.</P>
<P CLASS="western" STYLE="margin-bottom: 0.2in">Now move into</P>
<BLOCKQUOTE CLASS="western">glideinWMS/install</BLOCKQUOTE>
<P CLASS="western" STYLE="margin-bottom: 0.2in">and execute</P>
<BLOCKQUOTE CLASS="western">./glideinWMS_install</BLOCKQUOTE>
<P CLASS="western" STYLE="margin-bottom: 0.2in">You will be presented
with this screen:</P>
<BLOCKQUOTE CLASS="western">What do you want to install?<BR>(May
select several options at one, using a , separated list)<BR>[1]
glideinWMS Collector<BR>[2] Glidein Factory<BR>[3] GCB<BR>[4] pool
Collector<BR>[5] Schedd node<BR>[6] Condor for VO Frontend<BR>[7] VO
Frontend<BR>[8] Components</BLOCKQUOTE>
<P CLASS="western" STYLE="margin-bottom: 0.2in">Select <B>1</B>.</P>
<P CLASS="western" STYLE="margin-bottom: 0.2in">Now follow the
instructions and install all the software components. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.2in">Most of the questions
should be fairly straightforward (see an example installation
snapshot in <A HREF="factory_root_install_snaphot.txt">factory_root_install_snaphot.txt</A>).<BR>The
part that is not completely automatic is the configuration of the GSI
security. You will need to specify the DNs of the glidein pool
collector, the VO fontend and of all the submit machines. See
<A HREF="gsi_config.html">Configuring GSI security in Condor</A> for
more details. 
</P>
<H3>4.1 Example config files 
</H3>
<P CLASS="western" STYLE="margin-bottom: 0.2in">If following the
above instructions does not make you feel confident, you can find the
complete Condor config files
in<BR><A HREF="example-config/glide-factory/mymachine/condor_config">example-config/glide-factory/mymachine/condor_config</A><BR>and<BR><A HREF="example-config/glide-factory/mymachine/condor_config.local">example-config/glide-factory/mymachine/condor_config.local</A>.</P>
<H2 CLASS="western">5. Glidein Factory installation guide 
</H2>
<P CLASS="western" STYLE="margin-bottom: 0.2in">The glidein factory
should be installed as a non privileged user, for example the user
<B>gfactory</B>.</P>
<P CLASS="western" STYLE="margin-bottom: 0.2in">Move into</P>
<BLOCKQUOTE CLASS="western">glideinWMS/install</BLOCKQUOTE>
<P CLASS="western" STYLE="margin-bottom: 0.2in">and execute</P>
<BLOCKQUOTE CLASS="western">./glideinWMS_install</BLOCKQUOTE>
<P CLASS="western" STYLE="margin-bottom: 0.2in">You will be presented
with this screen:</P>
<BLOCKQUOTE CLASS="western">What do you want to install?<BR>(May
select several options at one, using a , separated list)<BR>[1]
glideinWMS Collector<BR>[2] Glidein Factory<BR>[3] GCB<BR>[4] pool
Collector<BR>[5] Schedd node<BR>[6] Condor for VO Frontend<BR>[7] VO
Frontend<BR>[8] Components</BLOCKQUOTE>
<P CLASS="western" STYLE="margin-bottom: 0.2in">Select <B>2</B>.</P>
<P CLASS="western" STYLE="margin-bottom: 0.2in">Now follow the
instructions and install all the software components.</P>
<P CLASS="western" STYLE="margin-bottom: 0.2in">Most of the questions
should be fairly straightforward (see an example installation
snapshot in <A HREF="factory_gf_install_snaphot.txt">factory_gf_install_snaphot.txt</A>).<BR>The
only part that is not completely automatic is the listing of GCB
nodes.</P>
<P CLASS="western" STYLE="margin-bottom: 0.2in">At this point you can
start the factory with</P>
<BLOCKQUOTE CLASS="western">cd ../../glideinWMS/factory<BR>python
glideFactory.py 60 5 /home/gfactory/glidein_submit/glidein_v1_0
&gt;/dev/null 2&gt;&amp;1 &lt;/dev/null&amp; 
</BLOCKQUOTE>
<P CLASS="western">where the directory is the one written out by the
installation script.</P>
<H3>5.1 Manual configuration</H3>
<P CLASS="western">The glidein factory can also be configured
manually.<BR>The complete guide can be found in the <A HREF="../manual/factory/entry.html">glideinWMS
documentation</A>, but in <A HREF="example-config/glide-factory/config_v1.xml">example-config/glide-factory/config_v1.xml</A>
you can find a working example.<BR><BR>
</P>
<P CLASS="western">Once a configuration file has been created, you
can create the glidein factory by executing</P>
<BLOCKQUOTE CLASS="western">cd glideinWMS/creation<BR>./create_glidein
 config_v1.xml</BLOCKQUOTE>
<P CLASS="western">The startup procedure is the same as described
above.</P>
<H2 CLASS="western">6 Glidein Factory monitoring 
</H2>
<P CLASS="western" STYLE="margin-bottom: 0.2in">There are several
ways to monitor the entry points of the glidein factory:</P>
<UL>
	<LI><P CLASS="western">Using the Web monitoring</P>
	<LI><P CLASS="western">Using the WMS tools</P>
	<LI><P CLASS="western">Looking at the glidein factory log files 
	</P>
	<LI><P CLASS="western">Looking at the glidein outputs 
	</P>
	<LI><P CLASS="western" STYLE="margin-bottom: 0.2in">Checking the WMS
	collector ads</P>
</UL>
<H3>6.1 Glidein factory entry Web monitoring</H3>
<P CLASS="western">You can either monitor the factory as a whole, or
just a single entry point.<BR><BR>The factory monitoring is located
at a URL like the one below</P>
<P CLASS="western" STYLE="margin-left: 0.42in">http://node1.my.company.org/glidefactory/monitor/glidein_v1_0/</P>
<P CLASS="western">Moreover, each entry point, has its own history on
the Web.<BR><BR>Assuming you have a SanDiego entry, it  can be
monitored at</P>
<P CLASS="western" STYLE="margin-left: 0.42in; margin-bottom: 0.2in">http://nopde1.my.company.org/glidefactory/monitor/glidein_v1_0/entry_SanDiego/</P>
<H3>6.2 Glidein factory monitoring via WMS tools</H3>
<P CLASS="western">You can get the equivalent of the Web page snaphot
by using 
</P>
<BLOCKQUOTE CLASS="western">cd glideinWMS/tools/<BR>python
wmsXMLView.py</BLOCKQUOTE>
<H3>6.3 Glidein factory entry log files 
</H3>
<P CLASS="western">The glidein factory writes two log files per entry
point <B>factory_info.YYYYMMDD.log</B> and
<B>factory_err.YYYYMMDD.log</B>.<BR><BR>Assuming you have a SanDiego
entry, the log files are in</P>
<BLOCKQUOTE CLASS="western">/home/gfactory/glidein_submit/glidein_v1_0/entry_SanDiego/log</BLOCKQUOTE>
<P CLASS="western" STYLE="margin-bottom: 0.2in">All errors are
reported in the <B>factory_err.YYYYMMDD.log</B>. file, while
<B>factory_info.YYYYMMDD.log </B>contains entries about what the
factory is doing.</P>
<H3>6.4 Glidein output 
</H3>
<P CLASS="western">Each glidein creates 2 files on exit; job.<B>ID</B>.out
and job.<B>ID</B>.err.<BR><BR>Assuming you have a  SanDiego entries,
the log files are in</P>
<BLOCKQUOTE CLASS="western">/home/gfactory/glidein_submit/glidein_v1_0/entry_SanDiego/log</BLOCKQUOTE>
<P CLASS="western" STYLE="margin-bottom: 0.2in">Problems are usually
reasonably easy to spot.</P>
<H3>6.5 Glidein factory ClassAds in the WMS Collector 
</H3>
<P CLASS="western">The glidein factory also advertises summary
information in the WMS collector.<BR><BR>Use <B>condor_status</B>:</P>
<P CLASS="western" STYLE="margin-left: 0.42in">condor_status -any</P>
<P CLASS="western" STYLE="margin-bottom: 0.2in">and look for
<B>glidefactory</B> and <B>glidefactoryclient</B> ads.</P>
<HR SIZE=1>
<P CLASS="western"><A HREF="index.html">Back to the index</A><BR><BR><BR><BR><BR>
</P>
</BODY>
</HTML>