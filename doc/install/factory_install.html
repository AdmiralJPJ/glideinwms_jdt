<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>Installation of the WMS Collector and collocated glidein Factory</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.0  (Linux)">
	<META NAME="CREATED" CONTENT="20071107;13514400">
	<META NAME="CHANGED" CONTENT="20081031;14041800">
	<META NAME="CHANGEDBY" CONTENT="Igor Sfiligoi">
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>Installation of
the WMS Collector and collocated glidein Factory </FONT></FONT>
</H1>
<TABLE CELLPADDING=2 CELLSPACING=2>
	<TR>
		<TD VALIGN=TOP>
			<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>1. Description </FONT></FONT>
			</H2>
			<P><FONT FACE="Liberation Serif"><FONT SIZE=3>The glidein Factory
			node will be the <A HREF="http://www.cs.wisc.edu/condor/manual/v7.0/3_1Introduction.html#SECTION00411000000000000000">Condor
			Central Manager</A> for the WMS, i.e. it will run the Condor
			Collector and Negotiator daemons, but it will also act as a <A HREF="http://www.cs.wisc.edu/condor/manual/v7.0/3_1Introduction.html#SECTION00411000000000000000">Condor
			Submit node</A> for the glidein factory, running Condor schedds
			used for Grid submission.<BR>On top of that, this node also hosts
			the glidein factory daemons.</FONT></FONT></P>
			<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>2. Hardware
			requirements </FONT></FONT>
			</H2>
			<P><FONT FACE="Liberation Serif"><FONT SIZE=3>This machine needs
			<B>one or two CPUs</B> (one for the Condor damons, and one for the
			glidein factory daemons) and a moderate amount of <B>memory</B>
			(<B>1GB</B> should be enough).<BR>It must must be on the <B>public
			internet</B>, with <B>at least one port open to the world</B>; all
			worker nodes will load data from this node trough HTTP.<BR>The
			<B>disk</B> needed is for binaries, config files, log files and
			Web monitoring data (For just a few sites, <B>10GB</B> could be
			enough, larger installations will need <B>100+GB</B> to maintain a
			reasonable history). Monitoring can be pretty I/O intensive when
			serving many sites, so get the fastest disk you can afford.</FONT></FONT></P>
		</TD>
		<TD>
			<P><IMG SRC="overview_WMS_factory.png" NAME="graphics1" ALIGN=BOTTOM WIDTH=359 HEIGHT=213 BORDER=0>
						</P>
		</TD>
	</TR>
</TABLE>
<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>3. Needed software
</FONT></FONT>
</H2>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>A reasonably recent
Linux OS (SL4 used at press time).<BR>The <A HREF="https://twiki.grid.iu.edu/twiki/bin/view/Documentation/WebHome">OSG
client software</A>.<BR>A HTTP server, like <A HREF="http://www.apache.org/">Apache</A>
or <A HREF="http://www.stllinux.org/meeting_notes/2001/0719/tux/intro.html">TUX</A>.<BR>A
<A HREF="http://www.postgresql.org/">PostgreSQL server</A>.<BR>The
<A HREF="http://www.cs.wisc.edu/condor/downloads/">Condor
distribution</A>.<BR>The <A HREF="http://oss.oetiker.ch/rrdtool/">RRDTool
package</A>.<BR>The <A HREF="http://www.uscms.org/SoftwareComputing/Grid/WMS/glideinWMS/">glideinWMS
software</A>.</FONT></FONT></P>
<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>4. Base tools
installation instructions </FONT></FONT>
</H2>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>You will need to
install all tools but glideinWMS software as root. The whole process
is managed by a install script described below. <BR>The script will
try to automate the installation as much as possible, but you may
need manually download a few tarballs and RPMs for the script to use.
The install script has pointers to the relevant URLs where you can
download them, so be prepared to have a second terminal to perform
the downloads.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Now move into</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>glideinWMS/install</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>and execute</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>./glideinWMS_install</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>You will be presented
with this screen:</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>What do you
want to install?<BR>(May select several options at one, using a ,
separated list)<BR>[1] glideinWMS Collector<BR>[2] Glidein
Factory<BR>[3] GCB<BR>[4] pool Collector<BR>[5] Schedd node<BR>[6]
Condor for VO Frontend<BR>[7] VO Frontend<BR>[8] Components</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Select <B>1</B>.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Now follow the
instructions and install all the software components. </FONT></FONT>
</P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Most of the questions
should be fairly straightforward (see an example installation
snapshot in <A HREF="factory_root_install_snapshot.txt">factory_root_install_snapshot.txt</A>).<BR>The
part that is not completely automatic is the configuration of the GSI
security. You will need to specify the DNs of the glidein pool
collector, the VO frontend and of all the submit machines. See
<A HREF="gsi_config.html">Configuring GSI security in Condor</A> for
more details. </FONT></FONT>
</P>
<H3><FONT FACE="Verdana"><FONT SIZE=3>4.1 Example config files </FONT></FONT>
</H3>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>If following the above
instructions does not make you feel confident, you can find the
complete Condor config files
in<BR><A HREF="example-config/glide-factory/mymachine/condor_config">example-config/glide-factory/mymachine/condor_config</A><BR>and<BR><A HREF="example-config/glide-factory/mymachine/condor_config.local">example-config/glide-factory/mymachine/condor_config.local</A>.</FONT></FONT></P>
<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>5. Glidein Factory
installation guide </FONT></FONT>
</H2>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Before installing the
glidein factory, create a valid x509 proxy in
<B>~/.globus/x509_service_proxy</B>. You will also need to keep it
valid for the life of the factory. This proxy must, at any point in
time, have a validity of at least the longest expected job being run
by the glideinWMS (and not less than 12 hours).</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>How you keep this proxy
valid (via MyProxy, kx509, voms-proxy-init from a local certificate,
scp from other nodes, or other methods), is beyond the scope of this
document.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>The glidein factory
itself should be installed as a non privileged user, for example the
user <B>gfactory</B>.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Move into</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>glideinWMS/install</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>and execute</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>./glideinWMS_install</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>You will be presented
with this screen:</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>What do you
want to install?<BR>(May select several options at one, using a ,
separated list)<BR>[1] glideinWMS Collector<BR>[2] Glidein
Factory<BR>[3] GCB<BR>[4] pool Collector<BR>[5] Schedd node<BR>[6]
Condor for VO Frontend<BR>[7] VO Frontend<BR>[8] Components</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Select <B>2</B>.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Now follow the
instructions and install all the software components.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Most of the questions
should be fairly straightforward (see an example installation
snapshot in <A HREF="factory_gf_install_snapshot.txt">factory_gf_install_snapshot.txt</A>).<BR>The
only part that is not completely automatic is the listing of GCB
nodes.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>At this point you can
start the factory with</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>cd
/home/gfactory/glideinsubmit/glidein_v1_0<BR>./factory_startup start</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>where the directory is
the one written out by the installation script.</FONT></FONT></P>
<H3><FONT FACE="Verdana"><FONT SIZE=3>5.1 Manual configuration</FONT></FONT></H3>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>The glidein factory can
also be configured manually.<BR>The complete guide can be found in
the <A HREF="../manual/factory/entry.html">glideinWMS documentation</A>,
but in <A HREF="example-config/glide-factory/config_v1.xml">example-config/glide-factory/config_v1.xml</A>
you can find a working example.</FONT></FONT></P>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Once a configuration
file has been created, you can create the glidein factory by
executing</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>cd
glideinWMS/creation<BR>./create_glidein config_v1.xml</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>The startup procedure
is the same as described above.</FONT></FONT></P>
<H2><FONT FACE="Bitstream Vera Serif"><FONT SIZE=4>6 Glidein Factory
monitoring </FONT></FONT>
</H2>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>There are several ways
to monitor the entry points of the glidein factory:</FONT></FONT></P>
<UL>
	<LI><P><FONT FACE="Liberation Serif"><FONT SIZE=3>Using the Web
	monitoring</FONT></FONT></P>
	<LI><P><FONT FACE="Liberation Serif"><FONT SIZE=3>Using the WMS
	tools</FONT></FONT></P>
	<LI><P><FONT FACE="Liberation Serif"><FONT SIZE=3>Looking at the
	glidein factory log files </FONT></FONT>
	</P>
	<LI><P><FONT FACE="Liberation Serif"><FONT SIZE=3>Looking at the
	glidein outputs </FONT></FONT>
	</P>
	<LI><P><FONT FACE="Liberation Serif"><FONT SIZE=3>Checking the WMS
	collector ads</FONT></FONT></P>
</UL>
<H3><FONT FACE="Verdana"><FONT SIZE=3>6.1 Glidein factory entry Web
monitoring</FONT></FONT></H3>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>You can either monitor
the factory as a whole, or just a single entry point.<BR><BR>The
factory monitoring is located at a URL like the one below</FONT></FONT></P>
<DL>
	<DD STYLE="margin-bottom: 0.2in"><FONT FACE="Liberation Serif"><FONT SIZE=3>http://node1.my.company.org/glidefactory/monitor/glidein_v1_0/</FONT></FONT></DD></DL>
<P>
<FONT FACE="Liberation Serif"><FONT SIZE=3>Moreover, each entry
point, has its own history on the Web.<BR><BR>Assuming you have a
SanDiego entry, it can be monitored at</FONT></FONT></P>
<DL>
	<DD STYLE="margin-bottom: 0.2in"><FONT FACE="Liberation Serif"><FONT SIZE=3>http://nopde1.my.company.org/glidefactory/monitor/glidein_v1_0/entry_SanDiego/</FONT></FONT></DD></DL>
<H3>
<FONT FACE="Verdana"><FONT SIZE=3>6.2 Glidein factory monitoring via
WMS tools</FONT></FONT></H3>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>You can get the
equivalent of the Web page snaphot by using </FONT></FONT>
</P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>cd
glideinWMS/tools/<BR>python wmsXMLView.py</FONT></FONT></BLOCKQUOTE>
<H3><FONT FACE="Verdana"><FONT SIZE=3>6.3 Glidein factory entry log
files </FONT></FONT>
</H3>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>The glidein factory
writes two log files per entry point <B>factory_info.YYYYMMDD.log</B>
and <B>factory_err.YYYYMMDD.log</B>.<BR><BR>Assuming you have a
SanDiego entry, the log files are in</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>/home/gfactory/glidein_submit/glidein_v1_0/entry_SanDiego/log</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>All errors are reported
in the <B>factory_err.YYYYMMDD.log</B>. file, while
<B>factory_info.YYYYMMDD.log </B>contains entries about what the
factory is doing.</FONT></FONT></P>
<H3><FONT FACE="Verdana"><FONT SIZE=3>6.4 Glidein output </FONT></FONT>
</H3>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Each glidein creates 2
files on exit; job.<B>ID</B>.out and job.<B>ID</B>.err.<BR><BR>Assuming
you have a SanDiego entries, the log files are in</FONT></FONT></P>
<BLOCKQUOTE><FONT FACE="Liberation Serif"><FONT SIZE=3>/home/gfactory/glidein_submit/glidein_v1_0/entry_SanDiego/log</FONT></FONT></BLOCKQUOTE>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>Problems are usually
reasonably easy to spot.</FONT></FONT></P>
<H3><FONT FACE="Verdana"><FONT SIZE=3>6.5 Glidein factory ClassAds in
the WMS Collector </FONT></FONT>
</H3>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3>The glidein factory
also advertises summary information in the WMS collector.<BR><BR>Use
<B>condor_status</B>:</FONT></FONT></P>
<DL>
	<DD STYLE="margin-bottom: 0.2in"><FONT FACE="Liberation Serif"><FONT SIZE=3>condor_status
	-any</FONT></FONT></DD></DL>
<P>
<FONT FACE="Liberation Serif"><FONT SIZE=3>and look for <B>glidefactory</B>
and <B>glidefactoryclient</B> ads.</FONT></FONT></P>
<HR SIZE=1>
<P><FONT FACE="Liberation Serif"><FONT SIZE=3><A HREF="index.html">Back
to the index</A><BR><BR><BR></FONT></FONT><BR><BR>
</P>
</BODY>
</HTML>