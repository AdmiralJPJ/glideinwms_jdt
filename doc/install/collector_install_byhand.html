<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<head>

<style>
BODY, P, DIV, H1, H2, H3, H4, H5, H6, ADDRESS, OL, UL, TITLE, TD, OPTION, SELECT {
 font-family: Verdana;
 
}

BODY, P, DIV, ADDRESS, OL, UL, LI, TITLE, TD, OPTION, SELECT {  
  font-size: 10.0pt;
  margin-top:0pt;  
  margin-bottom:0pt;  
} 

BODY, P {
  margin-left:0pt; 
  margin-right:0pt;
}

BODY {
  line-height: ;
  background: white;
  margin: 6px;
  padding: 0px;
}

h6 { font-size: 10pt }
h5 { font-size: 11pt }
h4 { font-size: 12pt }
h3 { font-size: 13pt }
h2 { font-size: 14pt }
h1 { font-size: 16pt }

blockquote {padding: 10px; border: 1px #DDDDDD dashed }

a img {border: 0}

</style>




</head>


<body revision="dmqrsvn_21gvv2w9:143">

<h1>
  Installation of the glidein pool Collector
</h1>
<h2>
  1. Description
</h2>
The glidein pool Collector node will be the
<a href=http://www.cs.wisc.edu/condor/manual/v7.0/3_1Introduction.html#SECTION00411000000000000000 title="Condor manual">Condor
Central Manager</a> for the glidein pool, i.e. it&nbsp; will run the Condor
Collector and Negotiator daemons.<br>
These daemons define the glidein pool; if this node dies, the pool dies with it.<br>
<h2>
  2. Hardware requirements
</h2>
This machine needs <span style=FONT-WEIGHT:bold>2 fast CPUs</span> (one for the
Collector and one for the Negotiator) and a moderate amount of
<span style=FONT-WEIGHT:bold>memory</span>
(<span style=FONT-WEIGHT:bold>512MB</span> should be enough).<br>
It must have <span style=FONT-WEIGHT:bold>reliable network</span> connectivity
and must be <span style=FONT-WEIGHT:bold>on the public internet,</span> with
<span style=FONT-WEIGHT:bold>no firewalls</span>; all worker nodes will be
continuously sending UDP packets to the Collector.<br>
The machine must be <span style=FONT-WEIGHT:bold>very stable</span>; if the
Collector dies, the glidein pool dies with it (There are Condor technickes to
minimize this damage, but you should still try to choose the stablest machine
you can afford.)<br>
The <span style=FONT-WEIGHT:bold>disk</span> needed is just for Condor binaries
and log files (<span style=FONT-WEIGHT:bold>5GB</span> should be enough)<br>
<h2>
  3. Needed software
</h2>
Any
<a href=http://www.cs.wisc.edu/condor/manual/v7.0/1_5Availability.html title="Available architectures">Condor-supported
OS</a>.<br>
The
<a href=https://twiki.grid.iu.edu/twiki/bin/view/Documentation/WebHome title="OSG User Web page">OSG
client software</a>.<br>
The
<a href=http://www.cs.wisc.edu/condor/downloads/ title="Condor download page">Condor
distribution</a>.<br>
<h2>
  4. Installation instructions
</h2>
The installation will assume you install Condor v7.0.5 on a Linux machine, from
tarballs, as root.<br>
The install directory will be
<span style=FONT-WEIGHT:bold>/opt/glidecondor</span>, the working directory is
<span style=FONT-WEIGHT:bold>/opt/glidecondor/condor_local</span> and the
machine name is <span style=FONT-WEIGHT:bold>mymachine.fnal.gov</span>.<br>
If you want to use a different setup, make the necessary changes.<br>
<h3>
  4.1 Install Condor<br>
</h3>
Follow instructions in the
<a href="condor_v7.0.5_install.html" title="Condor v7.0.5 installation document">Condor
v7.0.5 installation document</a>.<br>
<h3>
  4.2 Disable schedd and startd on this node
</h3>
Unless you plan to use this node for other purpuses, too, change DAEMON_LIST in
<span style=FONT-WEIGHT:bold>/opt/glidecondor/condor_local/condor_config.local</span>,
to:<br>
<div style=MARGIN-LEFT:40px>
  DAEMON_LIST&nbsp;&nbsp; = MASTER, COLLECTOR, NEGOTIATOR<br>
</div>
<h3>
  4.3 Configure Condor Negotiator
</h3>
UDP packets over WAN tend to get lost. Force Negotiator to prefer resources that
recently announced themselves, by adding the following lines in
<span style=FONT-WEIGHT:bold></span><span style=FONT-WEIGHT:bold>/opt/glidecondor/condor_local/condor_config.local</span>:<br>
<div style=MARGIN-LEFT:40px>
  ############################################################<br>
  ## Tuning<br>
  ############################################################<br>
  NEGOTIATOR_POST_JOB_RANK = MY.LastHeardFrom<br>
</div>
<h3>
  4.4 Configure Condor security
</h3>
Follow instructions in the
<a href="gsi_config.html" title="Configuring GSI security in Condor">Configuring
GSI security in Condor</a> document.<br>
<br>
The <span style=FONT-WEIGHT:bold>/opt/glidecondor/certs/grid-mapfile</span> must
be populated with the pool service proxy DN, as well as the DNs of all the used
schedds and glidein factories (i.e. glideins).<br>
Assuming the local service proxy DN is
"/DC=org/DC=doegrids/OU=Service/CN=glide1", you have two schedds sharing the
same DN "/DC=org/DC=doegrids/OU=Service/CN=schedd1", and that glideins use the
DN "/DC=org/DC=doegrids/OU=Service/CN=gwn2", the grid-mapfile would contain
something like:<br>
<div style=MARGIN-LEFT:40px>
  "/DC=org/DC=doegrids/OU=Service/CN=glide1" ccondor<br>
  "/DC=org/DC=doegrids/OU=Service/CN=schedd1" scondor1<br>
  "/DC=org/DC=doegrids/OU=Service/CN=gwn2" wcondor<br>
</div>
The names you specify after the DN are not important, but they must differ one
from another.<br>
<h3>
  4.5 Example config files
</h3>
You can find the complete config files in<br>
<a href=example-config/glide-pool-collector/mymachine/condor_config title=/opt/glidecondor/etc/condor_config>example-config/glide-pool-collector/mymachine/condor_config</a><br>
and<br>
<a href=example-config/glide-pool-collector/mymachine/condor_config.local title=/opt/glidecondor/condor_local/condor_config.local>example-config/glide-pool-collector/mymachine/condor_config.local</a><br>
<h2>
  5. Starting condor
</h2>
To start Condor, login as root in a fresh terminal, and issue:<br>
<div style=MARGIN-LEFT:40px>
  /opt/glidecondor/sbin/condor_master<br>
</div>
You should see three processes run as user condor: condor_master,
condor_collector and condor_negotiator.<br>
<br>
The log files can be found in
<span style=FONT-WEIGHT:bold>/opt/glidecondor/condor_local/log</span>.<br>
<br>
<a href="index.html" title="Back to the index">Back
to the index</a><br>
<hr><P ALIGN=LEFT><b>glideinWMS support:</b> glideinwms-support@fnal.gov</p>
<br></body>
</html>
