<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<head>

<style>
BODY, P, DIV, H1, H2, H3, H4, H5, H6, ADDRESS, OL, UL, TITLE, TD, OPTION, SELECT {
 font-family: Verdana;
 
}

BODY, P, DIV, ADDRESS, OL, UL, LI, TITLE, TD, OPTION, SELECT {  
  font-size: 10.0pt;
  margin-top:0pt;  
  margin-bottom:0pt;  
} 

BODY, P {
  margin-left:0pt; 
  margin-right:0pt;
}

BODY {
  line-height: ;
  background: white;
  margin: 6px;
  padding: 0px;
}

h6 { font-size: 10pt }
h5 { font-size: 11pt }
h4 { font-size: 12pt }
h3 { font-size: 13pt }
h2 { font-size: 14pt }
h1 { font-size: 16pt }

blockquote {padding: 10px; border: 1px #DDDDDD dashed }

a img {border: 0}

</style>




</head>


<body revision="dmqrsvn_30hfrqww:122">

<h1>
  Installation of a VO Frontend
</h1>
<h2>
  1. Description
</h2>
The VO Frontend will match user jobs with glidein factory ads. It is responsible
for the submission of new glideins.<br>
<br>
The VO Frontend will be installed as user
<span style=FONT-WEIGHT:bold>gfrontend</span>, and the home directory will be
<span style=FONT-WEIGHT:bold>/home/gfrontend</span>. The name of the node is
<span style=FONT-WEIGHT:bold>mymachine.fnal.gov</span>.<br>
The
<a href="factory_install.html" title="Installation of the WMS Collector">WMS
collector</a> is located on
<span style=FONT-WEIGHT:bold>wmspool.fnal.gov</span>, the
<a href="collector_install.html" title="Installation of the glidein pool Collector node">glidein
pool collector</a> is located on
<span style=FONT-WEIGHT:bold>mypool.fnal.gov</span>, and there are two
<a href="schedd_install.html" title="Installation of a scheduler node">schedd
nodes</a>, each with 4+1 schedds (as per
<a href="schedd_install.html" title="Installation of a scheduler node">installation
instructions</a> ), located at
<span style=FONT-WEIGHT:bold>mysubmit1.fnal.gov</span> and
<span style=FONT-WEIGHT:bold>mysubmit5.fnal.gov</span>.<br>
If you want to use a different setup, make the necessary changes.<br>
<h2>
  2. Hardware requirements
</h2>
This machine needs <span style=FONT-WEIGHT:bold>a fast&nbsp; CPU</span> and a
moderate amount of <span style=FONT-WEIGHT:bold>memory</span>
(<span style=FONT-WEIGHT:bold>512MB</span> should be enough).<br>
The <span style=FONT-WEIGHT:bold>disk</span> needed is just for binaries, config
files and log files (<span style=FONT-WEIGHT:bold>2GB</span> should be enough)<br>
<h2>
  3. Needed software
</h2>
Any
<a href=http://www.cs.wisc.edu/condor/manual/v6.9/1_5Availability.html title="Available architectures">Condor-supported
OS</a>.<br>
The
<a href=https://twiki.grid.iu.edu/twiki/bin/view/Documentation/WebHome title="OSG User Web page">OSG
client software</a>.<br>
The
<a href=http://www.cs.wisc.edu/condor/downloads/ title="Condor download page">Condor
distribution</a>.<br>
<h2>
  4. Condor installation<br>
</h2>
The VO Frontend can use any Condor installation, as long as it points to the
glidein pool Collector.<br>
If you don't have already Condor installed, consider:<br>
<ol type=a>
  <li>
    collocating it on <a href="gcb_install.html" title="a GCB node">a
    GCB node</a> (using the OSG client, as described below)<br>
  </li>
  <li>
    collocating it on
    <a href="schedd_install.html" title="a submitter node">a submitter
    node</a> or
    <a href="collector_install.html" title="the glidein pool Collector node">the
    glidein pool Collector node</a>,
  </li>
  <li>
    using the Condor distribution that comes with the OSG client software (see
    below)<br>
  </li>
</ol>
<br>
<h3>
  4.1 OSG client software installation
</h3>
If you have not installed the OSG client in
<span style=FONT-WEIGHT:bold>/opt/vdt</span> already, do it now.<br>
<i>(Note: An EGEE/gLite Grid User Interface will work as well, but you need to
replace /opt/vdt with whatever is appropriate for that installation)</i><br>
<br>
To install OSG 0.6.0 client, as of the time of writing, you would execute the following as <b>root</b><br>
(please be aware that you will need gcc, g++ and python-devel installed, and that you may need <b>-pretend-platform</b> packman option on some systems):<br>
<blockquote>mkdir /opt/vdt<br>
cd /opt/vdt<br>
wget http://physics.bu.edu/pacman/sample_cache/tarballs/pacman-3.19.tar.gz<br>
tar --no-same-owner -xzvf pacman-3.19.tar.gz<br>
cd pacman-3.19<br>
source setup.sh<br>
cd ..<br>
pacman -trust-all-caches -get OSG:client<br>
#Do you agree to the licenses? [y/n] y<br>
#Would you like to enable the Condor batch system to run automatically? n<br>
#Would you like to setup daily rotation of VDT log files? y<br>
#Do you want to update the CA certification revocation lists (CRLs)
automatically? [y/n] y<br>
#Where would you like to install CA files? r<br>
<br>
# If you have already a condor version installed on the system<br>
# uncomment the line below<br>
#pacman -remove Condor<br>
# and ignore the error messages<br>
source setup.sh<br>
vdt-control --on<br>
</blockquote>
<p>
  PS: The most up-to-date instructions can be found on
  <a href=https://twiki.grid.iu.edu/twiki/bin/view/ReleaseDocumentation/ClientInstallationGuide title="OSG client installation guide">https://twiki.grid.iu.edu/twiki/bin/view/ReleaseDocumentation/ClientInstallationGuide</a>.<br>
  <span style=FONT-STYLE:italic>(Please notice that those installation
  instructions tell you to install in ~/client_directory, please use /opt/vdt
  instead)</span>
</p>
<h3>
  4.1.1 OSG Condor configuration
</h3>
<font color=#ff0000><font color=#990000>WARNING</font>: Condor
<font color=#990000><b>v6.8.3,</b></font> shipped with the current OSG VDT
client, has a broken condor_q binary. If you want to use this version, you need
to replace the <font color=#990000><b>condor_q</b></font> binary with a more
recent one (maybe from another node).</font><br>
<br>
If you plan to use the condor installation that comes with this package, you
need to properly configure it.<br>
<br>
Modify <b>/opt/vdt/condor/local.*/condor_config.local</b> to contain:<br>
<blockquote># make sure you never start any Condor daemon<br>
DAEMON_LIST = None<br>
<br>
# point to the glidein pool collector<br>
CONDOR_HOST = mypool.fnal.gov<br>
<br>
# setup basic GSI security<br>
GSI_DAEMON_TRUSTED_CA_DIR=/opt/vdt/globus/TRUSTED_CA<br>
SEC_DEFAULT_AUTHENTICATION = OPTIONAL<br>
SEC_DEFAULT_AUTHENTICATION_METHODS = GSI<br>
SEC_DEFAULT_ENCRYPTION = OPTIONAL<br>
SEC_DEFAULT_INTEGRITY = OPTIONAL<br>
</blockquote><br>
Finally, put in <b>/home/gfrontend/.bashrc</b>:<br>
<blockquote>export PATH=/opt/vdt/condor/bin:$PATH<br>
export CONDOR_CONFIG=/opt/vdt/condor/etc/condor_config<br>
</blockquote>(Remember to exit end reenter the shell to pick up the new
environment)
<h2>
  5. VO Frontend installation
</h2>
This document describes how to install the VO Frontend found in
<a href=http://home.fnal.gov/%7Esfiligoi/glideinWMS/ title="glideinWMS Home Page">glideinWMS</a>
v0_8.<br>
<br>
Unless otherwise stated, all the installation is done as user gfrontend.<br>
<h3>
  5.1 Setup the GSI security
</h3>
Create and maintain the a valid x509 proxy in
<span style=FONT-WEIGHT:bold>~/.globus/x509_service_proxy</span>.<br>
How you keep this proxy valid (via
<a href=http://grid.ncsa.uiuc.edu/myproxy/ title="MyProxy home page">MyProxy</a>,
<a href=http://www.kx509.org/ title="kx509 Mode Page">kx509</a>, voms-proxy-init
from a local certificate, scp from other nodes, or other methods), is beyond the
scope of this document.<br>
<br>
Setup the environment, by adding the following lines to
<span style=FONT-WEIGHT:bold>~/.bashrc</span>:<br>
<div style=MARGIN-LEFT:40px>
  VDT_BASE=/opt/vdt<br>
  export X509_CERT_DIR=$VDT_BASE/globus/TRUSTED_CA<br>
  export X509_USER_PROXY=~/.globus/x509_service_proxy<br>
</div>
<br>
Make sure the DN of this proxy is put into the
<span style=FONT-WEIGHT:bold>grid-mapfile</span> on the
<a href="factory_install.html" title="Installation of the WMS Collector">WMS
collector</a>.<br>
<br>
<h3>
  5.2 Get glideinWMS binaries
</h3>
In your home directory, check&nbsp; out glideinWMS from CVS:<br>
<div style=MARGIN-LEFT:40px>
  export CVSROOT=:pserver:anonymous@cdcvs.fnal.gov:/cvs/cd_read_only<br>
  cvs co -r v0_8 glideinWMS<br>
</div>
<h3>
  5.3 Create a configuration file
</h3>
Get one of the examples in
<span style=FONT-WEIGHT:bold>~/glideinWMS/frontend/config_examples/</span>
and&nbsp; copy it to
<span style=FONT-WEIGHT:bold>~/glideinWMS/frontend/myfontend.cfg</span>.<br>
<br>
In <span style=FONT-WEIGHT:bold>~/glideinWMS/frontend/myfontend.cfg</span>
change:<br>
<div style=MARGIN-LEFT:40px>
  frontend_name='&lt;select a name here&gt;'<br>
  factory_pool='wmspool.fnal.gov'<br>
  schedd_names=['mysubmit1.fnal.gov','schedd_jobs1@mysubmit1.fnal.gov','schedd_jobs2@mysubmit1.fnal.gov','schedd_jobs3@mysubmit1.fnal.gov','schedd_jobs4@mysubmit1.fnal.gov','mysubmit5.fnal.gov','schedd_jobs1@mysubmit5.fnal.gov','schedd_jobs2@mysubmit5.fnal.gov','schedd_jobs3@mysubmit5.fnal.gov','schedd_jobs4@mysubmit5.fnal.gov']<br>
  glidein_params={"GLIDEIN_Collector":"mypool.fnal.gov"}<br>
</div>
There are other options that can be changed, but I will leave it to the
<a href=../manual/frontend/index.html#management title="glideinWMS VO Frontend ">glideinWMS
manual</a>.<br>
<br>
Please note that you need to create the directory specified as <b>log_dir</b>.<br>
<h2>
  6. Starting the VO Frontend
</h2>
Decide how often should the VO Frontend query the schedds and the WMS collector,
how often should it advertise itself, and finally execute
<span style=FONT-WEIGHT:bold>~/glideinWMS/factory/glideinFrontend.py:</span><br>
<div style=MARGIN-LEFT:40px>
  cd ~/glideinWMS/frontend/<br>
  python glideinFrontend.py 60 5&nbsp; myfrontend.cfg &gt;/dev/null 2&gt;&amp;1
  &lt;/dev/null&amp;<br>
</div>
<br>
<hr size=2 width=100%><a href="index.html" title="Back to the index">Back
to the index</a><br>
<br>
<br></body>
</html>
