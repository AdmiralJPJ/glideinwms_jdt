<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
  <title>GlideinWMS</title>
  <link rel="stylesheet" type="text/css" href="../common/glideinWMS.css" media="screen, projection" />
</head>

<body lang="en-US" dir="ltr">
    <h1>
        <a href="index.html">GlideinWMS</a>
	<span>The Glidein-based Workflow Management System</span>
    </h1>
    <ul class="breadcrumbs">
        <li><a href="../index.html">Home</a></li>
        <li><a href="./index.html">Components</a></li>
        <li>JWT</li>
    </ul>
    <div class="clear" />
    <div class="leftmenu">
        <ul class="components">
	        <li> <a href="../index.html">Home</a></li>
	        <li> <a href="../download.html">Download</a></li>
	        <li> <a href="../frontend/index.html">Glidein Frontend</a></li>
	        <li> <a href="../factory/index.html">WMS Factory</a></li>
	        <li> <a href="../components/index.html" >Components</a></li>
	        <li> <a href="../components/faq.html" class="last">FAQ</a></li>
        </ul>
        <div class="search">
            <script>
            (function() {
                var cx = '013439253731257915088:h-xvmglqvrq';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
            })();
            </script>
            <gcse:search enableAutoComplete=true></gcse:search>
        </div>
    </div>
<div class="content">
    <div class="heading">
    <h2>Components</h2>
	<ul class="subcomponents">
	     <li> <a href="./index.html">Overview</a></li>
	     <li> <a href="./user_pool.html">User Pool</a></li>
	     <li> <a href="./user_schedd.html">User Schedd</a></li>
         <li> JWT</li>
	     <li class="last"> <a href="./condor.html">HTCondor</a></li>
	</ul>
        <h3>JWT Authentication</h3>
	</div>
<div class="jump">
<u>Jump to:</u>
<ol>
    <li> <a href="#reference">Quick Reference</a></li>
    <li><a href="#software">Required Software Packages</a></li>
    <li><a href="#install">Installation</a></li>
    <li><a href="#configure">Configuration</a></li>

</ol>
</div>
<div class="related">
<ul>
<li><a href="../factory/troubleshooting.html#colorcoded">JWT Quick Color-coded Guide</a></li>
</div>
<div class="section">
<a name="reference" />
<h2>1. Quick Reference Guide to JWT Authentication Setup</h2>

<p>
JWT, or Json Web Tokens, are replacing GSI as the main authentication method for OSG services such as   
Condor and GlideinWMS. Two types of JWTs are discussed here:
<ol>
  <li><a href="https://scitokens.org/technical_docs/Claims">SciTokens</a>
  <li><a href="https://htcondor.readthedocs.io/en/latest/admin-manual/security.html?highlight=IDTOKEN#introducing-idtokens">IDTokens</a>
</ol>

</p>  
<table class="requirements">
  <tbody><tr class="head">
    <td>Service</td>
    <td>Comments</td>

  </tr>
     <tr>
       <td>User Pool (Collector)</td>

       <td>
         <ul>
           <li>The user pool needs to have IDTOKENS authenticating it to all of the seperate HTCondor machines it authenticates with.
           </li>
           <li>This means that if the  User Collector, Glidein Pool Collector, User Schedd Nodes, and Glidein Frontend are all on seperate nodes, they must
             each  provide IDTOKENS to each other. Admins for the various nodes must coordinate condor_token_request and condor_token_request_approve operations to
             distribute  IDTOKENS as needed.
           </li>
           <li> The recieved tokens are placed in /etc/condor/tokens.d with root ownership
           <li> IDTOKENS can be mapped to users via condor_mapfiles but are usually not in a GWMS installation
         </ul>
       </td>

     </tr>
  <tr>
    <td>WMS Pool (Collector)</td>
       <td>
https://opensciencegrid.org/docs/other/install-gwms-frontend/         <ul>
           <li>See the User Pool token requirements.  Be aware that if there are multiple collecters for load balancing or HA, such as mycollector.fnal.gov and mycollector.cern.ch, the processes should be supplied with two IDTOKENS issued from both mycollector.fnal.gov and mycollector.cern.ch
           </li>
           </li>
         </ul>
       </td>
     </tr>
     <tr>
       <td>Glidein (Through Glidein Factory)</td>
       <td>
         <ul>
           <li>An IDTOKEN is generated by the frontend and passed on to the glidein via the factory.  Operators do not typically need to 
             involve themselves in this process unless an IDTOKEN is suspected of being compromised and needs to be revoked.
           </li>
         </ul>
       </td>
     </tr>
     <tr>
       <td>Glidein Frontend</td>

       <td>
         <ul>
           <li>A SciToken must be generated and placed in the &lt;credentials&gt; section of the frontend.xml to authorize submission to CEs
           <li> The CE admin must map the SciToken to a uid on the CE, which obviously  requires coordination between CE and Frontend admins 
           <li> The frontend admin needs to generate IDTOKENS for the frontend uid and place them in ~frontend/.condor/tokens.d.  See the <a href="../factory/troubleshooting.html#colorcoded">JWT Quick Color-coded Guide</a> for a description of the subject these tokens need.
         </ul>
       </td>

     </tr>
     <tr>
       <td>User Schedd</td>
       <td>
         <ul>
           <li>Same requirements as Collectors above
           </li>
         </ul>
       </td>
     </tr>
</tbody></table> 
</div>
<div class="section">
<h2><a name="software">2. Required Software Packages</a></h2>
    <ul>

    <li>
    The <a href="https://opensciencegrid.org/docs/common/yum/">Open Science Grid Yum Repositories"</a>
    </li>
    <li>
    The <a href="https://docs.fedoraproject.org/en-US/epel/#_quickstart">Epel Yum Repositories</a>
    </li>
    <li>
    Machines Capable of installing and running Epel and OSG RPMS.  Currently Red Hat 7 and variants.
    </li>
     </ul>
</div>


<div class="section">
<h2><a name="install">3. Installation </a></h2>

    <br> Installation of GlideinWMS Factory or Frontend v 3.7.4 or greater will be JWT authentication compatible.
    <ul>

    <li>
      <a href="https://opensciencegrid.org/docs/other/install-gwms-frontend">Frontend Installation Guide</a>
    </li>
    <li>
      <a href="https://opensciencegrid.org/operations/services/install-gwms-factory">Factory Installation Guide</a>
     </ul>
</div>
<div class="section">
<h2><a name="configure">4. Configuration </a></h2>
</div>
<div class="footer">
Banner image by
<a href="http://www.flickr.com/people/leafwarbler/">Madhusudan Katti</a>
used under Creative Commons license.<br>
Original Home URL: <a href="https://glideinwms.fnal.gov">https://glideinwms.fnal.gov</a>.
GlideinWMS email support: glideinwms-support at fnal.gov
</div>
</div>
</body>
</html>
