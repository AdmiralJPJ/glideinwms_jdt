<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>The Glidein Factory Daemon</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.4  (Linux)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGEDBY" CONTENT="Igor Sfiligoi">
	<META NAME="CHANGED" CONTENT="20081007;13265400">
	<META NAME="CHANGEDBY" CONTENT="Igor Sfiligoi">
	<META NAME="CHANGEDBY" CONTENT="Igor Sfiligoi">
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1>The Glidein Factory Daemon</H1>
<H2>Description</H2>
<P>This document describes the internals of a glideinWMS Factory
Daemon.</P>
<H2>Index</H2>
<UL>
	<LI><P><A HREF="#overview">Glidein Factory Overview</A></P>
	<LI><P><A HREF="#flow">Program flow</A></P>
	<LI><P><A HREF="#source">Source code distribution</A></P>
	<LI><P><A HREF="#config">Configuration files</A></P>
</UL>
<H2><A NAME="overview"></A>Glidein Factory Overview</H2>
<P>A <A HREF="index.html">Glidein Factory</A> is composed of a
Factory Daemon and several Factory Entry Daemons. Each Entry Daemon
is autonomous; it advertises itself and processes the incoming
requests. The main Factory Daemon just launches and monitors the
Factory Entry Daemons.<BR>See the picture below for a logical
overview.<BR><BR><BR><IMG SRC="entry_points_overview.png"><BR><BR>All
daemons of a Glidein Factory share the same directory tree. The root
of the tree contains the common startup and configuration files,
while each entry point has a few additional configuration files on
its own.</P>
<H2><A NAME="flow"></A>Program flow</H2>
<P>The main tasks of the Factory Daemon are the startup up the Entry
Daemons and the aggregation of statistics from the entries.<BR>See
picture below for an overview.</P>
<P><IMG SRC="flow_factory_main.png"><BR CLEAR=LEFT>The
only non trivial operation in the statistics aggregation. The Factory
Daemon reads the XML files produced by the Factory Daemons,
aggregates them, and writes out an aggregate XML file. It also
updates the <A HREF="http://oss.oetiker.ch/rrdtool/">RRD</A> files
used to keep the history and creates the rrdtool graphs and HTML
pages for human consumption.<BR>See picture below for an overview.</P>
<P><IMG SRC="flow_factory_stats.png"><BR CLEAR=LEFT><BR><BR>
</P>
<H2><A NAME="source"></A>Source code distribution</H2>
<P>The Factory Daemon is implemented as a series of python scripts,
and it does not need to be pre-compiled.</P>
<P>The code is spread over several python modules, some specific to
the factory other shared between different parts of the glideinWMS.
There are also an external dependency on the <A HREF="http://oss.oetiker.ch/rrdtool/">rrdtool</A>
python libraries.<BR>The picture below shows the dependency tree.</P>
<P><IMG SRC="modules_factory.png"><BR CLEAR=LEFT>glideFactory.py
is executable.</P>
<P>The glideinWMS common libraries are in glideinWMS/lib directory.</P>
<H2><A NAME="config"></A>Configuration files</H2>
<P>The Factory daemon reads a signle configuration file:<br>
<TT>glidein.descript</TT><BR>
located in the root of the factory configuration tree.</P>
<P>Only two elements of this configuration file are used:</P>
<UL>
	<LI><P><TT>Entries</TT> - The list of entries, used to launch the Entry Daemons.</P>
	<LI><P><TT>LoopDelay</TT> - How long should it sleep between iterations.</P>
</UL>
<P></P>
<TABLE WIDTH=100% BORDER=0 CELLPADDING=2 CELLSPACING=2>
	<TR VALIGN=TOP>
		<TD>
			<H2 ALIGN=LEFT>Repository</H2>
			<H3 ALIGN=LEFT>CVSROOT</H3>
			<P ALIGN=LEFT>cvsuser@cdcvs.fnal.gov:/cvs/cd</P>
			<H2 ALIGN=LEFT>Package(s)</H2>
			<P ALIGN=LEFT>glideinWMS/factory</TD>
		<TD>
			<H2 ALIGN=LEFT>Author(s)</H2>
			<P ALIGN=LEFT>Since Aug. 14th 2006 - Igor Sfiligoi (Fermilab
			Computing Division)</TD>
	</TR>
</TABLE>
<P><BR><BR>
</P>
</BODY>
</HTML>
