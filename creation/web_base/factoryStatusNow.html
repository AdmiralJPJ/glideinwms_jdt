<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Glidein</title>

<script type="text/javascript">


//LOAD XML Object if it exits. 

var frontEndTable; 
var linkShown = 0; 
var loading = 1; 
var updating = 0; 
var col; 
var feArryMaster = new Array(); 
var preUpdateSort; 
var thead; 
var updated; 
var numberRows = 0;
var totalEntriesMaster;
var totalEntries; 
var totalMaster; 
var total;
var sorted = 0;
var previousSort;
var currentSort; 
var frontEnds; 
var listMade = 0; 
var frontEnd = 0;
var table; 
var select;
var nameLast;
var txt2 = new Array(1000); 
var count = 0; 
var tableMade = 0;  
var index = 0; 
var columnArray = new Array("requestIdle", "requestMax", "statusHeld", "statusIdle", "statusOther", "statusPending", "statusRunning",  "statusStageIn",
                            "statusStageOut", "statusWait", "cmGlideinIdle", "cmGlideinRunning", "cmGlideinTotal", "cmGlideinInfoAge", "cmGlideinJobsIdle", 
							 "cmGlideinJobsRunning");
var columnArry = new Array("requestidle", "requestmax", "statusheld", "statusidle", "statusother", "statuspending", "statusrunning",  "statusstagein",
                            "statusstageout", "statuswait", "cmglideinidle", "cmglideinrunning", "cmglideinyotal", "cmglideininfoAge", "cmglideinjobsIdle", 
							 "cmglideinjobsrunning");
var columnSearch = new Array("requested_idle", "requested_max_run", "status_held", "status_idle", "status_idle_other", "status_pending", "status_running", 
                             "status_stagein", "status_stageout", "status_wait", "client_monitor_glidein_idle", "client_monitor_glidein_running",
							 "client_monitor_clidein_total", "client_monitor_info_age", "client_monitor_jobs_idle", "client_monitor_jobs_running");
var exactColumns = new Array("Requested : Idle", "Requested: Max Run", "Status: Held", "Status: Idle", "Status: Idle Other", "Status: Pending", "Status: Running", 
                             "Status: Stage In", "Status: Stage Out", "Status: Wait", "Client Monitor: Glidein Idle", "Client Monitor: Glidein Running",
							 "Client Monitor: Glidein Total", "Client Monitor: Info Age", "Client Monitor: Jobs Idle", "Client Monitor: Jobs Running"); 
var preSortedEntriesArry = new Array();
var preSortedTotalArry = new Array();
var preFrontEndName = "Total"; 

function showPopUp(hoveritem)
{
	return; 
	if(preFrontEndName != "Total")
	{
		return; 
	}
	if(frontEndTable)
	{
		document.getElementById('hoverpopup').removeChild(frontEndTable);
	}
	
	column = hoveritem.cellIndex; 
	row = hoveritem.id; 
	frontEndTable = document.createElement('table'); 
	
	var entry = totalEntries[row -1]; 
	hover = document.getElementById("hoverpopup");
	head = document.getElementById("header");

	
	if(entry.lastElementChild.childElementCount == 0)
	{
		tr1 = document.createElement('tr'); 
		tr2 = document.createElement('tr'); 
		tr3 = document.createElement('tr'); 
		td1 = document.createElement('td');
		td2 = document.createElement('td');
		td3 = document.createElement('td'); 
		cont = document.createTextNode(totalEntries[row-1].attributes.getNamedItem("name").firstChild.data);
		cont2 = document.createTextNode(exactColumns[column - 1]);
		cont3 = document.createTextNode("No Frontends Exist");

		td1.appendChild(cont); 
		td2.appendChild(cont2);
		td3.appendChild(cont3); 

		tr1.appendChild(td1);
		tr2.appendChild(td2);
		tr3.appendChild(td3);
		
		frontEndTable.appendChild(tr1);
		frontEndTable.appendChild(tr2);
		frontEndTable.appendChild(tr3);

		hover.appendChild(frontEndTable); 

		hover.style.left = hoveritem.offsetLeft + "px";
		hover.style.top = 180 + "px";

		hover.style.visibility = "Visible";
		return; 
	}
	
	//hover.style.top = hoveritem.offsetTop + "px";
	hover.style.left = hoveritem.offsetLeft + "px";
	hover.style.visibility = "Visible";

}

function hidePopUp()
{
	if(preFrontEndName != "Total")
	{
		return; 
	}
	
	hover = document.getElementById("hoverpopup");
	hover.style.visibility = "Hidden";
}

function showErr()
{
	alert("The Glidein tool is currently only fully functional on the latest browsers. Update your browser and try again. We apologize for the inconvenience."); 	
	window.close(); 
}
function showTime()
{
	updated = updated[0].firstElementChild.attributes[3].firstChild.nodeValue;	
	document.getElementById("update").innerHTML= "XML last update:   " + updated; 	
}
function sortAlphabetical()
{
	sorted = 0;
	currentSort; 
	index = -2; 
	sortSignal(); 
	if(frontEnd == 0)
	{
		totalEntries = totalEntriesMaster;
		total = totalMaster; 
		numberRows = totalEntries.length;
		makeTable(); 
		fillIn();  
		return; 
	}
	loadFrontEnd(nameLast); 

}

function makeList()
{
	var feArry = new Array(); 
    feArryMaster = feArry; 
	if(select)
	{
		document.getElementById('tempList').removeChild(select);
	}
	select = document.createElement("select");
	select.setAttribute('id','choose');
	select.setAttribute("onchange", "loadFrontEnd(document.getElementById('choose').value)"); 
	var def = document.createElement("option"); 
	defTxt = document.createTextNode("Total (Default)");
	def.appendChild(defTxt); 
	select.appendChild(def); 
	
	for(i = 0; i< frontEnds.length; i++)
	{
		if(i == 0)
		{
			feArry.push(frontEnds[i]); 
			fe = document.createElement("option"); 
			txt1 = frontEnds[i].attributes.getNamedItem("name").firstChild.data;
			feTxt = document.createTextNode(txt1);
			fe.appendChild(feTxt); 
			select.appendChild(fe); 
			continue; 	
		}
		for(j = 0; j< feArry.length; j++)
		{
			if(feArry[j].attributes.getNamedItem("name").firstChild.data == frontEnds[i].attributes.getNamedItem("name").firstChild.data)
			{
				break; 	
			}
			if( j == (feArry.length - 1) && feArry[j].attributes.getNamedItem("name").firstChild.data != frontEnds[i].attributes.getNamedItem("name").firstChild.data)
			{
				feArry.push(frontEnds[i]); 
				fe = document.createElement("option"); 
				txt2[count] = frontEnds[i].attributes.getNamedItem("name").firstChild.data;
				feTxt = document.createTextNode(txt2[count]);
				fe.appendChild(feTxt);		
				select.appendChild(fe); 
				count++; 	
				break; 
			}
		}
	}
	
	listMade = 1;
	document.getElementById('tempList').appendChild(select);


}
function checkUrl()
{
	
	var url = window.location.search;
	var contents = new Array();
	var temp; 
	var pairsEqSplit = new Array();  
	if(url) 
	{
		url = url.substring(1); 
		var pairsAndSplit = url.split("&");
	 
	   // Load the key/values of the return collection
	 
	    for (var i = 0; i < pairsAndSplit.length; i++)
		{
        	pairsEqSplit[i] = pairsAndSplit[i].split("=");
   		}
		for(i = 0; i< pairsEqSplit.length; i++)
		{
			contents[i] = pairsEqSplit[i];
		}
		for(i = 0; i< contents.length; i++)
		{
			temp = contents[i]; 
			for(j = 0; j < temp.length; j++)
			{
				if(temp[j].search(/view/i) >= 0)
				{
					if(temp[j+1].search(/total/i) >= 0)
					{
						continue;   	
					}  
					for(z = 0; z< feArryMaster.length; z++)
					{
						if(temp[j+1] == feArryMaster[z].attributes.getNamedItem("name").firstChild.data)	
						{
							loadFrontEnd(temp[j+1]);
							select.selectedIndex = z + 1;  
						}
					}
					break; 			
				}
				if(temp[j].search(/sort/i) >= 0)
				{
					for(l = 0; l < columnArray.length; l++)
					{
						temp[j+1] = temp[j+1].toLowerCase(); 
						if(temp[j+1].search(columnSearch[l]) >= 0 || temp[j+1].search(columnArry[l]) >= 0)
						{
							sortTableDescending(columnArray[l]);
							break;  
						}
					}
				}
			}			
		}
	}
}

function loadFrontEnd(name)
{
	preFrontEndName = name; 
	if(name == "Total (Default)")
	{
		preFrontEndName = "Total"; 
		totalEntries = totalEntriesMaster; 
		total = totalMaster;
		numberRows = totalEntries.length; 
 		makeTable(); 
		frontEnd = 0; 
		if(sorted == 1 && currentSort == "ascending")
		{
			tableMade = 0;
			sorted = 0; 
			sortTableDescending(col); 
			sortTableAscending(col);
			return;   	
		}
		else if(sorted == 1 && currentSort == "descending")
		{
			tableMade = 0;
			sorted = 0;
			sortTableDescending(col); 
			sortSignal(); 
			return; 
		}
		
		fillIn(); 
		return; 	
		
	} 
	
   	nameLast = name; 
	var feEntries = new Array();
	var feTotal = new Array();
	totalEntries = totalEntriesMaster; 
	total = totalMaster; 
	tableMade = 0;   
	
	for(i = 0; i< totalEntries.length; i++)
	{
		if(totalEntries[i].childNodes[3].childElementCount != 0)
		{
			for(j = 1; j< totalEntries[i].childNodes[3].childNodes.length ; j+=2)
			{
				if(totalEntries[i].childNodes[3].childNodes[j].attributes.getNamedItem("name").firstChild.data == name)
				{
					feEntries.push(totalEntries[i]); 
					feTotal.push(totalEntries[i].childNodes[3].childNodes[j]); 
				}
			}
		}
	}
	frontEnd = 1;
	totalEntries = feEntries; 
	feTotal.push(1);
	total = feTotal;
	numberRows = totalEntries.length; 
	count = 0;
	if(sorted == 1 && currentSort == "ascending")
	{
		sorted = 0; 
		currentSort;
		makeTable();  
		sortTableDescending(col); 
		sortTableAscending(col);
		return;   	
	}
	else if(sorted == 1 && currentSort == "descending")
	{
		sorted = 0; 
		currentSort;
		makeTable();  
		sortTableDescending(col); 
		sortSignal(); 
		return; 
	}
	else
	{
		fillIn();
	}
}

function updateTable()
{ 
	updating = 1; 
	loadXMLDoc(); 
}
function fillIn()
{
	
	if(tableMade == 0)
	{
		makeTable();
	}
	if(listMade == 0)
	{
		makeList(); 	
	}
	
	document.getElementById("total").innerHTML= " &bull;" + "View has: " + numberRows + " Total Entries - (" + preFrontEndName + ")"; 
	var table = document.getElementById("table"); //Access to the entire table

	
	//Fill in entries 
	for( i = 0; i< numberRows; i++)
	{
		var y = totalEntries[i].attributes.getNamedItem("name").firstChild.data; 
		table.rows[i].cells[0].innerHTML = (i+1) + ':&nbsp&nbsp&nbsp;' + y;
	}
		
	//fill in the for non running entries. 
	for(j = 1; j < 17 ; j++)
	{	
		for(i = 0; i< total.length -1; i++)
		{
			if((total[i].childElementCount) == 0)
			{
				//fill in everything excpet the first column with 0 if entry is not doing anything.
				table.rows[i].cells[j].innerHTML = "0";					
			}	
		}
	}
	
	/*
	 * Fill in requested fields. 
	 */
	var attCount = 0; 
	for(var counter = 1; counter <= 2; counter++)
	{
		for(var i = 0; i< totalEntries.length; i++)
		{
			if(total[i].childElementCount != 0)
			{
				var item = total[i].childNodes[3].attributes[attCount].nodeValue;  	
				table.rows[i].cells[counter].innerHTML = item; 
			}
		}
		attCount++; 	
	}
	
	/* 
	 * Fill in status fields.  
	 */
	attCount = 0;
	for(var counter = 3; counter<= 10; counter++)
	{
		for(var i = 0; i< totalEntries.length; i++)
		{
			if(total[i].childElementCount != 0)
			{
				var item = total[i].lastElementChild.attributes[attCount].nodeValue;  	
				table.rows[i].cells[counter].innerHTML = item; 			
			}
		}
		attCount++; 
 	}
	
	/* 
     * Fill in client monitor fields 
 	 */
	attCount = 0; 
	for(var counter = 11; counter <= 16; counter++)
	{
		for(var i = 0; i< totalEntries.length; i++)
		{	
			if(total[i].childElementCount != 0)
			{
				var item = total[i].firstElementChild.attributes[attCount].nodeValue; 	
				table.rows[i].cells[counter].innerHTML = item; 
			}
		}
		attCount++; 
	}
	if(loading == 1)
	{
		loading = 0; 
	    checkUrl();
	}
	
}
function loadXMLDoc()
{
	 
	if (window.XMLHttpRequest)
	{// code for IE7+, Firefox, Chrome, Opera, Safari
		xmlhttp=new XMLHttpRequest();
	}
	else
	{// code for IE6, IE5
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
	  
	//Wait for server to reply that it is ready.   
	xmlhttp.onreadystatechange=function()
	{
		if (xmlhttp.readyState==4) //If 4 it it is ready. 
    	{
			updated = xmlhttp.responseXML.documentElement.getElementsByTagName("updated"); 
			showTime(); 
			totalEntriesMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			totalMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("total");     
			frontEnds = xmlhttp.responseXML.documentElement.getElementsByTagName("frontend"); 
			totalEntries = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			total = xmlhttp.responseXML.documentElement.getElementsByTagName("total");     
			totalEntriesHold = totalEntries; 
			numberRows = totalEntries.length;
			totalHold = total; 
			if(updating == 1)
			{
				/* Update table in default view, descending sort. (WORKS) */
				if(sorted != 0 && currentSort == 'descending' && frontEnd == 0)
				{
					currentSort;
					sorted = 0;
					updating = 0; 
					makeTable();
					tableMade = 0;  
					sortTableDescending(col); 
					sortSignal();
					return;  
				}
				/* Update table in default view, ascending sort. (WORKS) */
				if(sorted != 0 && currentSort == 'ascending' && frontEnd == 0)
				{
					currentSort;
					sorted = 0;
					updating = 0; 
					makeTable();
					tableMade = 0;  
					sortTableDescending(col);
					sortTableAscending(col);
					return; 
				}

				/* (WORKS) */
				if(sorted == 0 && frontEnd != 0)
				{
					frontEnd = 0;
					updating = 0;
					makeTable();
					loadFrontEnd(preFrontEndName);
					return; 
				}
				/**/
				if(sorted != 0 && currentSort == 'ascending' && frontEnd != 0)
				{
					currentSort;
					sorted = 0; 
					frontEnd = 0; 
					updating = 0;
					loadFrontEnd(preFrontEndName); 
					tableMade = 0; 
					sortTableDescending(col); 
					sortTableAscending(col);
					return; 
				}
				if(sorted != 0 && currentSort == 'descending' && frontEnd != 0)
				{
					currentSort;
					sorted = 0; 
					frontEnd = 0;
					updating = 0; 
					loadFrontEnd(preFrontEndName); 
					tableMade = 0; 
					sortTableDescending(col);
					sortSignal();
					return; 
				}
			}
			updating = 0; 
			preFrontEndName = "Total"; 
			tableMade = 0; 
    		frontEnd = 0; 
			sorted = 0;
			listMade = 0; 
			currentSort;
			fillIn(); /* Fill in all the values. */
 
			
		} 
			 
	}
	xmlhttp.open("GET", "schedd_status.xml",true);
	xmlhttp.send(null);

	
}
function makeTable() 
{
if(table)
{
	document.getElementById('scroll').removeChild(table);
	document.getElementById('header').removeChild(thead); 
}

var row=new Array();
var cell=new Array();

var row_num=numberRows+1; //edit this value to suit
var cell_num=17; //edit this value to suit

thead = document.createElement('table');
thBody = document.createElement('tbody');
thead.setAttribute('id', 'thead');

table = document.createElement('table');
tBody=document.createElement('tbody');
table.setAttribute('id','table');


for(c = 0; c < row_num; c++)
{
	row[c] = document.createElement('tr');
	
	row[c].setAttribute('id', 'entries'); 
	if(c > 0)
	{
		row[c].setAttribute('onmouseover', "this.bgColor='#FFFF66'");
		row[c].setAttribute('onmouseout', "this.bgColor='#F2F2F2'"); 
	}
	for(k = 0; k < cell_num; k++) 
	{
		cell[k] = document.createElement('td');
	
		if(c > 0 && k> 0)
		{
			cell[k].setAttribute('onmouseover', 'showPopUp(this)');
			cell[k].setAttribute('onmouseout', 'hidePopUp()');
			cell[k].setAttribute('id', c);  				
		}
		if(c > 0 && k == 0)
		{
			cell[k].setAttribute('width', '25%'); 		
		}
		if(c > 0 && k> 0 && k <= 2)
		{
			cell[k].setAttribute('width', '6%'); 	
		}
		if(c > 0 && k > 2)
		{
			cell[k].setAttribute('width', '4.5%'); 	
		}
		if( c == 0 && k == 0)
		{
			cont = document.createTextNode("Entry Name")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'entryName'); 
	    	cell[k].setAttribute("onclick", "sortAlphabetical()");
			cell[k].setAttribute('width', '25%'); 
		}
		if( c == 0 && k == 1)
		{
			cont = document.createTextNode("Requested: Idle")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'requestIdle');
		    cell[k].setAttribute("onclick", "sortTableDescending('requestIdle') "); 
			cell[k].setAttribute('width', '6%'); 
		}
		if( c == 0 && k == 2)
		{
			cont = document.createTextNode("Requested: Max Run")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'requestMax'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('requestMax') "); 
			cell[k].setAttribute('width', '6%'); 
		}
		if( c == 0 && k == 3)
		{
			cont = document.createTextNode("Status: Held")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusHeld'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusHeld') ");
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 4)
		{
			cont = document.createTextNode("Status: Idle")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusIdle'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusIdle') "); 
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 5)
		{
			cont = document.createTextNode("Status: Idle Other")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusOther'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusOther') "); 
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 6)
		{
			cont = document.createTextNode("Status: Pending")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusPending'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusPending') ");
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 7)
		{
			cont = document.createTextNode("Status: Running")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusRunning'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusRunning') "); 
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 8)
		{
			cont = document.createTextNode("Status: StageIn")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusStageIn'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusStageIn') ");
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 9)
		{
			cont = document.createTextNode("Status: StageOut")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusStageOut'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusStageOut') ");
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 10)
		{
			cont = document.createTextNode("Status: Wait")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusWait'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusWait') ");
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 11)
		{
			cont = document.createTextNode("Client Monitor: Glidein Idle")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinIdle'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinIdle') ");
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 12)
		{
			cont = document.createTextNode("Client Monitor: Glidein Running")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinRunning'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinRunning') ");
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 13)
		{
			cont = document.createTextNode("Client Monitor: Glidein Total")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinTotal'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinTotal') "); 
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 14)
		{
			cont = document.createTextNode("Client Monitor: Info Age")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinInfoAge'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinInfoAge') ");
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 15)
		{
			cont = document.createTextNode("Client Monitor: Jobs Idle")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinJobsIdle'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinJobsIdle') ");
			cell[k].setAttribute('width', '4.5%'); 
		}
		if( c == 0 && k == 16)
		{
			cont = document.createTextNode("Client Monitor: Jobs Running")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinJobsRunning'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinJobsRunning')"); 
			cell[k].setAttribute('width', '4.5%'); 
		}
		
		if( c > 0 )
		{
			cont = document.createTextNode(c+"")
			cell[k].appendChild(cont);
		}
		
		row[c].appendChild(cell[k]);
		
	}
	if(c == 0)
	{
		thBody.appendChild(row[c]); 
	}
	else
	{
		tBody.appendChild(row[c]);
	}
	tableMade = 1;
	
}
thead.appendChild(thBody); 
table.appendChild(tBody); 
document.getElementById('header').appendChild(thead); 
document.getElementById('scroll').appendChild(table);
document.getElementById('scroll').style.height = (window.innerHeight - 74) + "px"; 	
} 

function setHeight()
{
	document.getElementById('scroll').style.height = (window.innerHeight - 74) + "px"; 
}

function sortSignal()
{
	for(i = 0; i < 17; i++)
	{
		for(j = 0; j< totalEntries.length; j++)
		{
			if(i != (index + 1))
			{
				table.rows[j].cells[i].bgColor = "#F2F2F2";  
			}
		}
		thead.rows[0].cells[i].bgColor =  "#E0E0E0"; 
	}
    if(index == -2)
	{
	   return; 	
	}
	for(i = 0; i< totalEntries.length; i++)
	{
		table.rows[i].cells[index + 1].bgColor = "#CCCCCC"; 	   
	}
	thead.rows[0].cells[index + 1].bgColor = "#CCCCCC"; 
	
	
}
function sortTableAscending(column)
{


	col = column; 
	var newTotal = new Array(); 
	var newEntries = new Array();
	var i = 0; 
	var counter = 0;
	var child; 
	var att; 

	if(column == columnArray[0])
	{
		child = 3; att = 0; index = 0; sortSignal(); 
	}
	if(column == columnArray[1])
	{
		child = 3; att = 1; index = 1; sortSignal(); 
	}
	if(column == columnArray[2])
	{
		child = 5; att = 0; index = 2; sortSignal(); 
	}   
	if(column == columnArray[3])
	{
		child = 5; att = 1; index = 3; sortSignal(); 
	}  
	if(column == columnArray[4])
	{
		child = 5; att = 2; index = 4; sortSignal();
	}
	if(column == columnArray[5])
	{
		child = 5; att = 3; index = 5; sortSignal();
	} 
	if(column == columnArray[6])
	{
		child = 5; att = 4; index = 6; sortSignal();
	}
	if(column == columnArray[7])
	{
		child = 5; att = 5; index = 7; sortSignal();
	} 
	if(column == columnArray[8])
	{
		child = 5; att = 6; index = 8; sortSignal();
	}
	if(column == columnArray[9])
	{
		child = 5; att = 7; index = 9; sortSignal();
	} 
	if(column == columnArray[10])
	{
		child = 1; att = 0; index = 10; sortSignal();
	} 
	if(column == columnArray[11])
	{
		child = 1; att = 1; index = 11; sortSignal();
	} 
	if(column == columnArray[12])
	{
		child = 1; att = 2; index = 12; sortSignal();
	} 
	if(column == columnArray[13])
	{
		child = 1; att = 3; index = 13; sortSignal();
	} 
	if(column == columnArray[14])
	{
		child = 1; att = 4; index = 14; sortSignal();
	}
	if(column == columnArray[15])
	{
		child = 1; att = 5; index = 15; sortSignal();
	}


	/* Empty entries. */
	for(var i = totalEntries.length - 1; i >= 0; i--)
	{
		if(total[i].childElementCount == 0)
		{		
			newTotal.push(total[i]); 
			newEntries.push(totalEntries[i]); 	
		}
	}

	for(var i = totalEntries.length - 1; i >= 0; i--)
	{	
		if(total[i].childElementCount != 0)
		{
			if(parseInt(total[i].childNodes[child].attributes[att].nodeValue) == 0)
			{
				newTotal.push(total[i]); 
				newEntries.push(totalEntries[i]); 
			}
		}
	}

	for(var i = totalEntries.length - 1; i >= 0; i--)
	{
		if(total[i].childElementCount != 0)
		{
		   if(total[i].childNodes[child].attributes[att].nodeValue > 0)
		   {
			   newTotal.push(total[i]); 
			   newEntries.push(totalEntries[i]); 
		   }	
		}
	}	

	currentSort = "ascending"; 
	newTotal.push(1);
	previousSort = column;
	total = newTotal; 
	totalEntries = newEntries; 
	preSortedEntriesArry = newEntries; 
	preSortedTotalArry = newTotal; 
	sorted = 1;
	preUpdateSort = 1;  
	fillIn();
	

}
function sortTableDescending(column)
{
col = column; 
if(previousSort != column)
{
	sorted = 0; 
}
if(sorted == 1 && currentSort != "ascending")
{
	sorted = 0; 
 	sortTableAscending(column); //replace sortTableDescending(column) 
    return; 
}

var newTotal = new Array(); 
var newEntries = new Array();
var i = 0; 
var counter = 0;
var child; 
var att; 

	if(column == columnArray[0])
	{
		child = 3; att = 0; index = 0; sortSignal(); 
	}
	if(column == columnArray[1])
	{
		child = 3; att = 1; index = 1; sortSignal(); 
	}
	if(column == columnArray[2])
	{
		child = 5; att = 0; index = 2; sortSignal(); 
	}   
	if(column == columnArray[3])
	{
		child = 5; att = 1; index = 3; sortSignal(); 
	}  
	if(column == columnArray[4])
	{
		child = 5; att = 2; index = 4; sortSignal();
	}
	if(column == columnArray[5])
	{
		child = 5; att = 3; index = 5; sortSignal();
	} 
	if(column == columnArray[6])
	{
		child = 5; att = 4; index = 6; sortSignal();
	}
	if(column == columnArray[7])
	{
		child = 5; att = 5; index = 7; sortSignal();
	} 
	if(column == columnArray[8])
	{
		child = 5; att = 6; index = 8; sortSignal();
	}
	if(column == columnArray[9])
	{
		child = 5; att = 7; index = 9; sortSignal();
	} 
	if(column == columnArray[10])
	{
		child = 1; att = 0; index = 10; sortSignal();
	} 
	if(column == columnArray[11])
	{
		child = 1; att = 1; index = 11; sortSignal();
	} 
	if(column == columnArray[12])
	{
		child = 1; att = 2; index = 12; sortSignal();
	} 
	if(column == columnArray[13])
	{
		child = 1; att = 3; index = 13; sortSignal();
	} 
	if(column == columnArray[14])
	{
		child = 1; att = 4; index = 14; sortSignal();
	}
	if(column == columnArray[15])
	{
		child = 1; att = 5; index = 15; sortSignal();
	}

/* Get everything that is not 0. */
for(var i = 0; i< totalEntries.length; i++)
{
	if(total[i].childElementCount != 0)
	{
	   if(total[i].childNodes[child].attributes[att].nodeValue > 0)
	   {
		   newTotal.push(total[i]); 
		   newEntries.push(totalEntries[i]); 
	   }	
	}
}
	
for(var i=0; i< newTotal.length - 1; i++)    // element to be compared
{
    for(var j = i+1; j < newTotal.length; j++)   // rest of the elements
    {
		if (parseInt(newTotal[i].childNodes[child].attributes[att].nodeValue) <= parseInt(newTotal[j].childNodes[child].attributes[att].nodeValue))          
        {
            temp = newTotal[i];              // swap
			newTotal[i] = newTotal[j];
            newTotal[j] = temp;
			temp = newEntries[i];            // swap
			newEntries[i] = newEntries[j];
            newEntries[j] = temp;
        }
	}
}
for(var i = totalEntries.length - 1; i >= 0; i--)
{	
	if(total[i].childElementCount != 0)
	{
		if(parseInt(total[i].childNodes[child].attributes[att].nodeValue) == 0)
		{
			newTotal.push(total[i]); 
			newEntries.push(totalEntries[i]); 
		}
	}
}	
/* Empty entries. */
for(var i = totalEntries.length -1; i >= 0; i--)
{
	if(total[i].childElementCount == 0)
	{		
		newTotal.push(total[i]); 
		newEntries.push(totalEntries[i]); 	
	}
}

currentSort = "descending";
newTotal.push(1);
previousSort = column; 
total = newTotal; 
totalEntries = newEntries; 
sorted = 1; 
preUpdateSort = 1; 
fillIn();

}
function goToLink()
{
	var constructed;
	var holder = document.URL.split('?');
	
	if(frontEnd != 0 && sorted != 0)
	{
		constructed = holder[0] + "?view=" + preFrontEndName + "&sort=" + col;
	}
	else if(frontEnd != 0 && sorted == 0)
	{
		constructed = holder[0]+ "?view="  + preFrontEndName;
	}
	else if(frontEnd == 0 && sorted != 0)
	{
		constructed = holder[0] + "?sort=" + col;
	}
	else
	{
		constructed = holder[0];
	}
	document.location.href = constructed;
			
}




</script>
<style = "text/css">

td
{
	border: 2px solid #BBB;
	border-width: thin;
	font-size:12px;
	padding:5px;
}
#title
{
	color: #000; 	
	font: bold 330%/100% "Times New Roman";
	text-decoration:none;
	left:50%; 
}
#entries
{
	 font-weight: bold;  
}
#table
{
	table-layout: fixed; 
	width: 100%; 
	background-color:#F2F2F2;
}
#total
{
	color:#D00;
}
#thead
{
	table-layout: fixed;
 	width: 99%; 
	background-color:#E0E0E0;
}
#button
{
   font-family:Lucida Console,monospace;  
   font-weight:bold;
   color: #330000;
   width: 110px;
}
#choose 
{
	margin-left:auto;
	margin-right:auto;
	margin: 0;
	padding: 0;
	width: 170px;
}
#current
{
	color:#300;
	font-size:12px;
	font-weight:bold;
}
#update
{
	color: #303;
	font-size:13px;
	text-align: left;  
}
#scroll
{
	overflow: scroll;
	width: auto;
	min-height:90%; 
}
#hoverpopup
{
	visibility:hidden;
	position:absolute; 
	top:0; left:0;
	background-color: #999;
}
#link
{
	font-family:Lucida Console,monospace;   
	font-weight:bold;
	color: #330000;
    width: 70px;
	float:right;
}

</style>

</head>
<body onResize="setHeight()">
<script type = "text/javascript"> loadXMLDoc()  </script>
<a id = "title"  style="font-size: 40px" > Glidein Factory Status </a>

<h5 id = "total">(Total Entries)</h5>

<div id = "current">Select a view: </div>

<div id = "tempList"></div>

<br /><br /><br /><br />

<form  > <input id = "button" type="button" value="Update Table"  onclick="updateTable()"/> </form>
<form  > <input id = "link" type="button" value="Link" onclick="goToLink()" /> </form>

<br /><div id = "update"> XML Last update: </div> 

<div id ="header"> </div>
<div id ="scroll"></div> 
<div id="hoverpopup"> </div>


</body>
</html>
<html><body></body></html>